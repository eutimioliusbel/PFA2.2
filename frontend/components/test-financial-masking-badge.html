<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Financial Masking Badge - Manual Test</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: #f8fafc;
      padding: 2rem;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    .test-section {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      font-weight: 500;
      border: 1px solid;
    }
    .badge-critical {
      background: #fee2e2;
      color: #991b1b;
      border-color: #fecaca;
    }
    .badge-high {
      background: #fed7aa;
      color: #9a3412;
      border-color: #fdba74;
    }
    .badge-moderate {
      background: #fef3c7;
      color: #92400e;
      border-color: #fde68a;
    }
    .badge-low {
      background: #d1fae5;
      color: #065f46;
      border-color: #a7f3d0;
    }
    .tooltip {
      position: absolute;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      z-index: 50;
      display: none;
      max-width: 300px;
    }
    .tooltip.show {
      display: block;
    }
    .masked-cost {
      font-family: monospace;
      color: #9ca3af;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }
    .lock-icon {
      width: 14px;
      height: 14px;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="mb-8">
      <h1 class="text-4xl font-bold text-gray-900 mb-2">Financial Masking Badge</h1>
      <p class="text-gray-600">Manual Component Testing - Phase 7, Task 7.2</p>
    </header>

    <!-- Test Section 1: Badge Variants -->
    <div class="test-section">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Test 1: Badge Variants</h2>
      <div class="space-y-4">
        <div>
          <p class="text-sm text-gray-600 mb-2">Variant: Inline (default)</p>
          <div class="flex items-center gap-2">
            <span class="masked-cost">
              <svg class="lock-icon" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"/>
              </svg>
              ***masked***
            </span>
            <span class="badge badge-high" id="badge-1">
              ‚ö†Ô∏è High Budget
            </span>
          </div>
        </div>

        <div>
          <p class="text-sm text-gray-600 mb-2">Variant: Badge (compact)</p>
          <div class="flex items-center gap-2">
            <span class="masked-cost">
              <svg class="lock-icon" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"/>
              </svg>
              ***
            </span>
            <span class="badge badge-critical" id="badge-2">
              üö® Critical
            </span>
          </div>
        </div>

        <div>
          <p class="text-sm text-gray-600 mb-2">Variant: Full (detail view)</p>
          <div class="bg-gray-50 rounded-lg p-4 border border-gray-200 max-w-md">
            <div class="flex items-center gap-2 text-gray-700 mb-4">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path d="M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"/>
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z" clip-rule="evenodd"/>
              </svg>
              <h3 class="font-semibold">Cost Information</h3>
            </div>

            <div class="flex items-center gap-2 mb-4">
              <span class="text-2xl font-bold masked-cost">
                <svg class="lock-icon w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"/>
                </svg>
                ***masked***
              </span>
            </div>

            <span class="badge badge-high mb-4">
              ‚ö†Ô∏è Impact Level: High Budget
            </span>

            <div class="bg-white rounded-lg p-3 border border-gray-200 space-y-2 text-sm">
              <div class="flex justify-between">
                <span class="text-gray-600">Percentile:</span>
                <span class="font-semibold text-gray-900">Top 5%</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Comparison:</span>
                <span class="font-semibold text-gray-900">3.2x average</span>
              </div>
              <div>
                <span class="text-gray-600">Impact:</span>
                <p class="font-medium text-gray-900 mt-1">Top 5% of crane costs</p>
              </div>
            </div>

            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mt-4">
              <p class="text-sm font-semibold text-blue-900 mb-2">üí° AI Insight:</p>
              <p class="text-sm text-blue-800">
                This equipment is significantly more expensive than typical cranes.
                Consider reviewing duration or exploring alternatives.
              </p>
            </div>

            <button class="w-full mt-4 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors">
              View Portfolio Insights
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Test Section 2: Impact Levels -->
    <div class="test-section">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Test 2: Impact Level Color Coding</h2>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div>
          <p class="text-xs text-gray-600 mb-2">CRITICAL</p>
          <span class="badge badge-critical">
            üö® Critical Impact
          </span>
        </div>
        <div>
          <p class="text-xs text-gray-600 mb-2">HIGH</p>
          <span class="badge badge-high">
            ‚ö†Ô∏è High Budget
          </span>
        </div>
        <div>
          <p class="text-xs text-gray-600 mb-2">MODERATE</p>
          <span class="badge badge-moderate">
            ‚ÑπÔ∏è Moderate Impact
          </span>
        </div>
        <div>
          <p class="text-xs text-gray-600 mb-2">LOW</p>
          <span class="badge badge-low">
            ‚úÖ Within Budget
          </span>
        </div>
      </div>
    </div>

    <!-- Test Section 3: Tooltip Behavior -->
    <div class="test-section">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Test 3: Tooltip Behavior (300ms delay)</h2>
      <p class="text-sm text-gray-600 mb-4">Hover over badge for 300ms to see tooltip:</p>
      <div class="relative inline-block" id="tooltip-container">
        <span class="badge badge-high cursor-help" id="badge-tooltip-trigger">
          ‚ö†Ô∏è High Budget
        </span>
        <div class="tooltip" id="tooltip">
          <div class="flex items-center gap-2 pb-2 border-b border-gray-200">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
            </svg>
            <span class="font-semibold text-sm text-gray-900">Budget Impact</span>
          </div>

          <div class="space-y-2 text-xs mt-3">
            <div class="flex justify-between">
              <span class="text-gray-600">Impact:</span>
              <span class="font-medium text-gray-900">High Budget</span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600">Comparison:</span>
              <span class="font-medium text-gray-900">3.2x average</span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600">Percentile:</span>
              <span class="font-medium text-gray-900">Top 5%</span>
            </div>
          </div>

          <div class="border-t border-gray-200 pt-2 mt-3">
            <p class="text-xs font-semibold text-gray-700 mb-1">üí° AI Insight:</p>
            <p class="text-xs text-gray-600">
              Consider standard 150T model instead
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Test Section 4: Loading State -->
    <div class="test-section">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Test 4: Loading Skeleton</h2>
      <div class="space-y-4">
        <div>
          <p class="text-sm text-gray-600 mb-2">Badge variant:</p>
          <div class="animate-pulse h-6 w-24 bg-gray-200 rounded"></div>
        </div>
        <div>
          <p class="text-sm text-gray-600 mb-2">Full variant:</p>
          <div class="animate-pulse space-y-2">
            <div class="h-4 w-32 bg-gray-200 rounded"></div>
            <div class="h-8 w-40 bg-gray-200 rounded"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Test Section 5: Verification Checklist -->
    <div class="test-section">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Verification Checklist</h2>
      <ul class="space-y-2 text-sm">
        <li class="flex items-center gap-2">
          <input type="checkbox" id="check1" class="w-4 h-4">
          <label for="check1">1. Badge shows correct impact level (CRITICAL/HIGH/MODERATE/LOW)</label>
        </li>
        <li class="flex items-center gap-2">
          <input type="checkbox" id="check2" class="w-4 h-4">
          <label for="check2">2. Tooltip appears after 300ms hover</label>
        </li>
        <li class="flex items-center gap-2">
          <input type="checkbox" id="check3" class="w-4 h-4">
          <label for="check3">3. Modal shows portfolio insights on click</label>
        </li>
        <li class="flex items-center gap-2">
          <input type="checkbox" id="check4" class="w-4 h-4">
          <label for="check4">4. AI-generated text is sanitized (no script tags)</label>
        </li>
        <li class="flex items-center gap-2">
          <input type="checkbox" id="check5" class="w-4 h-4">
          <label for="check5">5. Actual costs NEVER visible in DOM or network tab</label>
        </li>
        <li class="flex items-center gap-2">
          <input type="checkbox" id="check6" class="w-4 h-4">
          <label for="check6">6. Fallback works when API fails</label>
        </li>
        <li class="flex items-center gap-2">
          <input type="checkbox" id="check7" class="w-4 h-4">
          <label for="check7">7. Keyboard navigation works (Tab, Enter, ESC)</label>
        </li>
      </ul>
    </div>
  </div>

  <script>
    // Tooltip delay simulation
    let tooltipTimeout = null;
    const trigger = document.getElementById('badge-tooltip-trigger');
    const tooltip = document.getElementById('tooltip');

    trigger.addEventListener('mouseenter', () => {
      tooltipTimeout = setTimeout(() => {
        tooltip.classList.add('show');
      }, 300); // 300ms delay
    });

    trigger.addEventListener('mouseleave', () => {
      if (tooltipTimeout) {
        clearTimeout(tooltipTimeout);
        tooltipTimeout = null;
      }
      tooltip.classList.remove('show');
    });

    // Log tooltip delay for verification
    trigger.addEventListener('mouseenter', () => {
      const start = Date.now();
      const checkDelay = setInterval(() => {
        if (tooltip.classList.contains('show')) {
          const delay = Date.now() - start;
          console.log(`Tooltip appeared after ${delay}ms (expected: 300ms)`);
          clearInterval(checkDelay);
        }
      }, 10);
    });
  </script>
</body>
</html>
